
# Git Commit Dependency Graph Visualizer

## Описание

**Git Commit Dependency Graph Visualizer** — это инструмент командной строки для визуализации графа зависимостей коммитов в Git-репозитории, включая транзитивные зависимости. Он строит граф на основе заданного тега и отображает информацию о дате, времени и авторе каждого коммита.

Граф генерируется в формате Graphviz и сохраняется как изображение в формате PNG.

## Возможности

- **Построение графа зависимостей** для коммитов, начиная с указанного тега.
- **Отображение транзитивных зависимостей** — все предшествующие коммиты включаются в граф.
- **Вывод информации о коммитах**: дата, время и автор.
- **Настраиваемая визуализация графа** с использованием Graphviz.
- **Полное покрытие кода тестами** с использованием `pytest`.

## Требования

- **Python 3.6+**
- **Git**, установленный и доступный в `PATH`.
- **Graphviz**, установленный и доступный в `PATH`.
- **pytest** для запуска тестов (опционально).

## Установка

1. **Клонируйте репозиторий или скопируйте файлы проекта**:

   ```bash
   git clone https://github.com/xartd0/conf_upravlenie
   ```

2. **Перейдите в директорию проекта**:

   ```bash
   cd conf_upravlenie
   ```

3. **Установите необходимые зависимости** (если они не установлены):

   - **Установка Graphviz**:

     - **Ubuntu/Debian**:

       ```bash
       sudo apt-get update
       sudo apt-get install graphviz
       ```

     - **MacOS** (с использованием Homebrew):

       ```bash
       brew install graphviz
       ```

     - **Windows**:

       - Скачайте и установите Graphviz с [официального сайта](https://graphviz.org/download/).
       - Добавьте путь к `dot.exe` в переменную окружения `PATH`.

   - **Установка `pytest`** (для запуска тестов):

     ```bash
     pip install pytest
     ```

## Конфигурация

Создайте XML-файл конфигурации `config.xml` в корневой директории проекта. Пример содержимого:

```xml
<config>
    <graphviz_path>/usr/bin/dot</graphviz_path>
    <repo_path>/path/to/your/local/repo</repo_path>
    <output_path>/path/to/output/graph.png</output_path>
    <tag_name>your_tag_name</tag_name>
</config>
```

- **graphviz_path**: Путь к исполняемому файлу `dot` Graphviz. Вы можете узнать его, выполнив `which dot` в терминале.
- **repo_path**: Путь к локальному Git-репозиторию, для которого необходимо построить граф зависимостей.
- **output_path**: Путь и имя выходного файла изображения графа (должен оканчиваться на `.png`).
- **tag_name**: Имя тега в репозитории, начиная с которого будет строиться граф.

## Использование

Запустите скрипт `core.py`, указав путь к файлу конфигурации:

```bash
python3 core.py config.xml
```

После успешного выполнения вы увидите сообщение:

```
Graph generated successfully.
```

Сгенерированный граф будет сохранен по пути, указанному в `output_path` файла конфигурации.

## Пример

Допустим, у вас есть репозиторий в `/home/user/projects/my_repo`, и вы хотите построить граф коммитов, начиная с тега `v1.0.0`. Ваш `config.xml` будет выглядеть так:

```xml
<config>
    <graphviz_path>/usr/bin/dot</graphviz_path>
    <repo_path>/home/user/projects/my_repo</repo_path>
    <output_path>/home/user/projects/graph.png</output_path>
    <tag_name>v1.0.0</tag_name>
</config>
```

## Тестирование

Чтобы запустить тесты и убедиться в корректной работе скрипта, выполните:

```bash
pytest -v tests.py
```

Вы должны увидеть вывод, подтверждающий успешное прохождение всех тестов.

## Структура проекта

- **core.py**: Основной скрипт для визуализации графа зависимостей.
- **tests.py**: Набор тестов для проверки корректности работы функций.
- **config.xml**: Файл конфигурации с настройками для скрипта.
- **README.md**: Документация проекта.

## Требования к окружению

Убедитесь, что в вашем окружении:

- **Git** установлен и доступен в командной строке.
- **Graphviz** установлен, и путь к `dot` указан в `config.xml`.
- **Python 3.6** или более поздней версии.

## Возможные проблемы и их решения

- **Ошибка `FileNotFoundError: Tag 'your_tag_name' not found.`**:

  - Убедитесь, что тег с указанным именем существует в вашем локальном репозитории.
  - Проверьте правильность пути к репозиторию в `repo_path`.

- **Ошибка `Object '<sha1>' not found.`**:

  - Возможно, репозиторий использует упакованные объекты. Убедитесь, что скрипт обновлен для работы с `git cat-file`.
  - Убедитесь, что Git установлен и доступен в `PATH`.

- **Граф не читаем или слишком большой**:

  - Попробуйте изменить параметры визуализации в функции `generate_dot` или использовать другой движок Graphviz (например, `sfdp` или `twopi`).
  - Ограничьте количество коммитов, создавая граф для более конкретного тега или ветки.

